#!/bin/bash
urouter_dir="/urouter"
source $urouter_dir/urouter.uconf

####
#  U router system ramdisk shortcuts to system files
#  Backup location /urouter/Backup/systemfiles/*
datetimeuconf=`date "+D-%F-C-%k-%M"`
####

mkdir -p /urouter/Backup/systemfiles/$datetimeuconf
echo /urouter/Backup/systemfiles/$datetimeuconf

# isc-dhcp-server

mkdir -p /urouter/Backup/systemfiles/$datetimeuconf/etc/dhcp
mv /etc/dhcp/dhcpd.conf /urouter/Backup/systemfiles/$datetimeuconf/etc/dhcp
mv /etc/dhcp/dhcpd6.conf /urouter/Backup/systemfiles/$datetimeuconf/etc/dhcp

mkdir -p /urouter/Backup/systemfiles/$datetimeuconf/etc/default
mv /etc/default/isc-dhcp-server /urouter/Backup/systemfiles/$datetimeuconf/etc/default

ln -s $uetc/dhcp/dhcpd.conf /etc/dhcp/
ln -s $uetc/dhcp/dhcpd6.conf /etc/dhcp/
ln -s $uetc/default/isc-dhcp-server /etc/default/
# bind9
mkdir -p /urouter/Backup/systemfiles/$datetimeuconf/etc/bind
mv /etc/bind/named.conf /urouter/Backup/systemfiles/$datetimeuconf/etc/bind
ln -s $uetc/bind/named.conf /etc/bind/

# PPPOE
mkdir -p /urouter/Backup/systemfiles/$datetimeuconf/etc/ppp
mv /etc/ppp/ip-up /urouter/Backup/systemfiles/$datetimeuconf/etc/ppp
mv /etc/ppp/ip-down /urouter/Backup/systemfiles/$datetimeuconf/etc/ppp

mkdir -p /urouter/Backup/systemfiles/$datetimeuconf/etc/ppp/peers
mv /etc/ppp/peers/provideruconf /urouter/Backup/systemfiles/$datetimeuconf/etc/ppp/peers

ln -s $uetc/ppp/provideruconf /etc/ppp/peers
ln -s $uetc/ppp/ip-up /etc/ppp
ln -s $uetc/ppp/ip-down /etc/ppp
